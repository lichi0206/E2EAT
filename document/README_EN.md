## Mobile Apps Automation test framework

Note: Please write your test code under "test" folder.

### Project structure

1. src/main: Mainly for resources, no project code.
2. src/main/resources: TestNG xml files and APK files.
3. src/test: Automation code.
4. test-output: Report generated by ReportNG.

### POM

#### Dependencies

```xml
<dependencies>
        <dependency>
            <groupId>com.github.appium</groupId>
            <artifactId>java-client</artifactId>
            <version>7.3.0</version>
        </dependency>
        <dependency>
            <groupId>org.testng</groupId>
            <artifactId>testng</artifactId>
            <version>7.3.0</version>
        </dependency>
        <dependency>
            <groupId>org.uncommons</groupId>
            <artifactId>reportng</artifactId>
            <version>1.1.4</version>
            <scope>test</scope>
            <exclusions>
                <exclusion>
                    <groupId>org.testng</groupId>
                    <artifactId>testng</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
    </dependencies>
```

#### Plugins

Use surefire plugin to link the TestNG file with MVN TEST

```xml
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-surefire-plugin</artifactId>
    <version>2.20.1</version>
    <configuration>
        <testFailureIgnore>true</testFailureIgnore>
        <suiteXmlFiles>
            <!-- Location of TestNG xml -->
            <suiteXmlFile>${testngFileName}</suiteXmlFile>
        </suiteXmlFiles>
        <properties>
            <property>
                <name>suitethreadpoolsize</name>
                <value>2</value>
            </property>
            <!-- Use ReportNG to instead of the default report of TestNG -->
            <property>
                <name>usedefaultlisteners</name>
                <value>false</value>
            </property>
            <!-- listener -->
            <property>
                <name>listener</name>
                <value>org.uncommons.reportng.HTMLReporter, org.uncommons.reportng.JUnitXMLReporter</value>
            </property>
        </properties>
        <argLine>-Dfile.encoding=UTF-8</argLine>
    </configuration>
</plugin>
```

### TestNG

#### Use ReportNG to instead of default report

```xml
<listeners>
    <listener class-name="org.uncommons.reportng.HTMLReporter"/>
    <listener class-name="org.uncommons.reportng.JUnitXMLReporter"/>
</listeners>
```

#### Add prompt

```xml
<!DOCTYPE suite SYSTEM "http://testng.org/testng-1.0.dtd">
```

### How to run test

1. Right click TestNG.xml, run as...
2. Go to terminal, run `mvn test`

### Notes

#### Pass JVM parameters to MVN TEST

1. If you are using Surefire for UT, you can use Surefire plugin to configure the JVM parameters.

   ```xml
   <!-- In pom.xml file, add <argLine> for Surefire plugin -->
   <plugin>
       <groupId>org.apache.maven.plugins</groupId>
       <artifactId>maven-surefire-plugin</artifactId>
       <version>2.20.1</version>
       <configuration>
           <argLine>-Dfile.encoding=UTF-8</argLine>
           <argLine>-Dtestng.dtd.http=true</argLine>
       </configuration>
   </plugin>
   ```

2. You can also use ${maven.projectBasedir}/.mvn/jvm.config file (Create the file if not exist).

3. You can also add JVM parameters using maven-compiler-plugin.

   ```xml
   <plugin>
       <groupId>org.apache.maven.plugins</groupId>
       <artifactId>maven-compiler-plugin</artifactId>
       <configuration>
           <source>8</source>
           <target>8</target>
           <compilerArgs>
               <arg>-verbose</arg>
           </compilerArgs>
       </configuration>
   </plugin>
   ```

   ### Add Maven-Wrapper support
   
   #### Why use maven wrapper?
   
   TO ensure the maven version of the developer is consistent with the version of other users.
   
   #### How to use?
   
   The easiest way to setup the Maven Wrapper for your project is to use the [Takari Maven Plugin](https://github.com/takari/takari-maven-plugin) with its provided `wrapper` goal. To add or update all the necessary Maven Wrapper files to your project execute the following command:
   
   ```bash
   mvn -N io.takari:maven:0.7.7:wrapper
   ```
   
   > Note: The default usage should be `mvn -N io.takari:maven:wrapper` but for some users this seem to result in usage of an old version of the wrapper and therefore installation of older Maven defaults and so on.
   
   Normally you instruct users to install a specific version of Apache Maven, put it on the PATH and then run the `mvn` command like the following:
   
   ```
   mvn clean install
   ```
   
   But now, with a Maven Wrapper setup, you can instruct users to run wrapper scripts:
   
   ```
   ./mvnw clean install
   ```
   
   or on Windows
   
   ```
   mvnw.cmd clean install
   ```
   
   A normal Maven build will be executed with the one important change that if the user doesn't have the necessary version of Maven specified in `.mvn/wrapper/maven-wrapper.properties` it will be downloaded for the user first, installed and then used.
   
   Subsequent uses of `mvn`/`mvnw.cmd` use the previously downloaded, specific version as needed.